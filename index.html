<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>WhatsHack V3 Pro 1.1.0 — 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0e1114;
      --surface:#151a1f;
      --panel:#0f1419;
      --card:#11161b;
      --border:#1e2a33;
      --text:#e7f4ec;
      --muted:#9acfb8;
      --accent:#19e07b;
      --accent-2:#10c469;
      --warn:#ffd166;
      --error:#ff6b81;
      --ok:#35e0a1;
      --radius:14px;
      --shadow:0 20px 60px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.02);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:
        radial-gradient(900px 500px at -10% -20%, #1a2430 0%, transparent 60%),
        radial-gradient(800px 450px at 110% -10%, #18232c 0%, transparent 55%),
        var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }

    /* Ventana / Shell de app */
    .shell{min-height:100vh;display:grid;place-items:center;padding:24px}
    .window{
      width:min(920px,96vw);
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:20px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .titlebar{
      display:flex;align-items:center;justify-content:space-between;
      padding:10px 14px;border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.15)), #0d1216;
    }
    .titlegroup{display:flex;align-items:center;gap:12px}
    .dots{display:flex;gap:8px}
    .dot{width:12px;height:12px;border-radius:50%}
    .dot.red{background:#ff5f56}
    .dot.yellow{background:#ffbd2f}
    .dot.green{background:#27c93f}
    .appname{font-weight:800;letter-spacing:.3px}
    .version{font-size:12px;color:var(--muted)}

    .content{padding:18px}

    /* Tarjetas y elementos base */
    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
    }
    .title{
      font-size:20px;font-weight:900;letter-spacing:.3px;margin:0 0 6px 0;color:#c7f5df;
      text-shadow:0 1px 0 rgba(255,255,255,.04);
    }
    .subtitle{font-size:12px;color:var(--muted);margin-top:4px}

    /* Form login */
    .grid{display:grid;gap:12px}
    .login-grid{grid-template-columns: 1fr 2fr auto}
    @media (max-width: 740px){ .login-grid{grid-template-columns:1fr} }
    select,input,button{
      background:#0f1419;border:1px solid var(--border);color:var(--text);
      border-radius:10px;padding:12px 14px;font-size:15px;outline:none;
      transition:border-color .2s, box-shadow .2s, transform .05s;
    }
    select,input{width:100%}
    button{cursor:pointer;font-weight:800}
    .btn-primary{
      background: linear-gradient(180deg, var(--accent), var(--accent-2));
      color:#002312;border:1px solid rgba(25,224,123,.6);
      box-shadow: 0 10px 28px rgba(25,224,123,.25), inset 0 -6px 12px rgba(0,0,0,.25);
    }
    .btn-primary:active{transform:translateY(1px)}
    .btn-ghost{
      background:transparent;border:1px solid var(--border);color:var(--muted)
    }
    .row{display:flex;gap:10px;flex-wrap:wrap}

    /* Verificación */
    .verify{
      display:flex;align-items:center;gap:12px;justify-content:center;
      padding:14px;border:1px dashed var(--border);border-radius:12px;background:#0b1116;
      color:var(--muted)
    }
    .spinner{width:18px;height:18px;border:3px solid rgba(25,224,123,.25);border-top-color:var(--accent);border-radius:50%;animation:spin .9s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Progreso */
    .progress-wrap{margin-top:10px}
    .progress-container{
      height:20px;background:#10161b;border:1px solid var(--border);border-radius:999px;overflow:hidden;
    }
    .progress-bar{
      height:100%;width:0%;
      background: linear-gradient(90deg, var(--accent), #6effbf);
      box-shadow: 0 0 12px rgba(25,224,123,.45) inset, 0 2px 12px rgba(25,224,123,.35);
      transition:width .1s linear;
    }
    .pct{text-align:right;color:var(--muted);font-size:12px;margin-top:6px}

    /* Consola (solo monospace) */
    .console{margin-top:14px}
    .console h3{margin:0 0 8px 0;font-size:14px;color:var(--muted)}
    .log{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      background:#0a0f13;border:1px solid var(--border);border-radius:10px;
      max-height:220px;overflow:auto;padding:10px;font-size:13px;line-height:1.45
    }
    .log .info{color:#b8f7db}
    .log .warn{color:var(--warn)}
    .log .error{color:var(--error)}
    .log .ok{color:var(--ok)}
    .console-actions{display:flex;justify-content:flex-end;margin-top:8px}

    /* Resultados (botones/tiles) */
    .results{margin-top:12px;display:none}
    .grid-results{display:grid;grid-template-columns:repeat(auto-fit,minmax(190px,1fr));gap:12px}
    .result{
      background:linear-gradient(180deg,#0f1419,#0b1116);
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;text-align:center;font-weight:800;letter-spacing:.2px;
      box-shadow:var(--shadow);opacity:0;transform:translateY(6px) scale(.98);
      transition:opacity .3s ease, transform .3s ease;
    }
    .result.show{opacity:1;transform:translateY(0) scale(1)}
    .result .big{font-size:22px;color:#c9ffe5}
    .result .lbl{font-size:12px;color:var(--muted)}

    .footer-actions{display:flex;gap:10px;justify-content:center;margin-top:12px}

    .hidden{display:none !important}

    /* --- Mini-flag en select --- */
    .cc-wrap{ position:relative; }
    .cc-wrap select{ padding-left:46px; } /* espacio para la banderita */
    .flag{
      position:absolute; top:50%; left:12px; transform:translateY(-50%);
      width:22px; height:14px; border:1px solid var(--border); border-radius:3px;
      box-shadow:0 1px 2px rgba(0,0,0,.25); display:inline-block; overflow:hidden;
      background:#0f1419;
    }

    /* --- Chips de subetapas --- */
    .stages{
      margin-top:8px; display:flex; flex-wrap:wrap; gap:8px;
    }
    .chip{
      font-size:12px; padding:6px 10px; border:1px solid var(--border);
      border-radius:999px; color:var(--muted); background:#0f1419;
      transition:all .2s ease; opacity:.75;
    }
    .chip.active{
      color:#002312; background:linear-gradient(180deg, var(--accent), var(--accent-2));
      border-color:rgba(25,224,123,.6); box-shadow:0 0 0 2px rgba(25,224,123,.15) inset;
      opacity:1;
    }
    .chip.done{
      color:#aeeecf; background:#0f1a14; border-color:#214b35; opacity:1;
    }

    /* --- Pulso suave al 100% --- */
    .progress-bar.pulse{
      animation:pulseGlow 1.6s ease-out 1;
    }
    @keyframes pulseGlow{
      0%   { box-shadow:0 0 12px rgba(25,224,123,.45) inset, 0 2px 12px rgba(25,224,123,.35); }
      35%  { box-shadow:0 0 24px rgba(25,224,123,.65) inset, 0 0 18px rgba(25,224,123,.55); }
      100% { box-shadow:0 0 12px rgba(25,224,123,.45) inset, 0 2px 12px rgba(25,224,123,.35); }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="window">
      <div class="titlebar">
        <div class="titlegroup">
          <div class="dots"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span></div>
          <div>
            <div class="appname">WhatsHack V3 Pro</div>
            <div class="version">Versión 1.1.0</div>
          </div>
        </div>
        <div class="version">Estado • Activo</div>
      </div>

      <div class="content">
        <!-- LOGIN -->
        <section id="screen-login" class="card">
          <h2 class="title">Ingrese el número de WhatsApp</h2>
          <p class="subtitle">Seleccion el código de país y digite el número</p>
          <div class="grid login-grid" style="margin-top:12px">
            <!-- Mini-flag + select -->
            <div class="cc-wrap">
              <span id="flagIcon" class="flag" aria-hidden="true"></span>
              <select id="cc">
                <option value="+593">+593 (Ecuador)</option>
                <option value="+57">+57 (Colombia)</option>
                <option value="+51">+51 (Perú)</option>
                <option value="+52">+52 (México)</option>
                <option value="+54">+54 (Argentina)</option>
                <option value="+34">+34 (España)</option>
                <option value="+1">+1 (EE. UU.)</option>
              </select>
            </div>
            <input id="num" type="text" placeholder="9XX XXX XXX" inputmode="numeric" maxlength="15" />
            <button id="btnStart" class="btn-primary">Hackear</button>
          </div>
        </section>

        <!-- VERIFICACIÓN -->
        <section id="screen-verify" class="card hidden">
          <h2 class="title">Validando datos…</h2>
          <div class="verify"><div class="spinner"></div><span>Verificando cuenta de WhatsApp</span></div>
          <p id="verify-target" class="subtitle" style="text-align:center;margin-top:10px"></p>
        </section>

        <!-- PROGRESO -->
        <section id="screen-progress" class="card hidden">
          <h2 class="title">Hacking: <span id="target"></span></h2>

          <div class="progress-wrap">
            <div class="progress-container"><div class="progress-bar" id="bar"></div></div>
            <div class="pct" id="pct">0%</div>
          </div>

          <!-- Chips de subetapas -->
          <div class="stages" id="stages">
            <span class="chip" data-stage="init">Inicializando</span>
            <span class="chip" data-stage="conn">Conectando</span>
            <span class="chip" data-stage="anlz">Analizando</span>
            <span class="chip" data-stage="dec">Descifrando</span>
            <span class="chip" data-stage="val">Validando</span>
            <span class="chip" data-stage="fin">Finalizando</span>
          </div>

          <div class="console">
            <h3>Consola</h3>
            <div class="log" id="log"></div>
            <div class="console-actions">
              <button id="copyLogs" class="btn-ghost">Copiar logs</button>
            </div>
          </div>

          <div class="results" id="results">
            <div class="grid-results" id="grid"></div>
            <div class="footer-actions">
              <button id="btnReset" class="btn-ghost">Reiniciar</button>
              <button id="btnDetails" class="btn-primary">Detalles</button>
              <button id="btnExit" class="btn-ghost">Salir</button>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- MODAL DETALLES -->
  <div id="popup" class="hidden" style="position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.6);backdrop-filter:blur(2px);z-index:50">
    <div style="width:min(720px,92vw);background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:var(--shadow)">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <h3 style="margin:0;color:#c7f5df">🔐 Resultados Avanzados</h3>
        <button id="closePopup" class="btn-ghost">[X] Cerrar</button>
      </div>
      <pre id="advText" style="margin:0;white-space:pre-wrap;color:#c9ffe5;background:#0a0f13;border:1px solid var(--border);border-radius:12px;padding:10px;max-height:60vh;overflow:auto">
Códigos detectados:
 - QR WA Enlace activo: true
 - Puerto activo: 5222
 - Host principal: chat.whatsapp.net
 - Proxy: 10.87.1.66:443
 - API Bridge: api.whats.sim.wsp/v3
 - Mensajes cifrados: 1291
 - Fragmentos recuperados: 87%
 - Estado de sesión: sincronizada
 - Último backup: 14/03/2025 02:22
 - Dirección IP origen: 192.168.33.201
 - Región: South America / Ecuador
 - Red interceptada: WhatsApp LTE EC [Cod. 7xA3]
      </pre>
    </div>
  </div>

  <script>
    // Helpers
    const $ = s => document.querySelector(s);
    const nowTs = () => new Date().toLocaleTimeString();

    // Screens
    const sLogin = $('#screen-login');
    const sVerify = $('#screen-verify');
    const sProg  = $('#screen-progress');

    // Login
    const ccEl = $('#cc');
    const numEl = $('#num');
    const btnStart = $('#btnStart');

    // Verify
    const verifyTarget = $('#verify-target');

    // Progress
    const targetEl = $('#target');
    const barEl = $('#bar');
    const pctEl = $('#pct');
    const logEl = $('#log');
    const copyBtn = $('#copyLogs');

    // Results
    const resultsWrap = $('#results');
    const grid = $('#grid');
    const btnReset = $('#btnReset');
    const btnDetails = $('#btnDetails');
    const btnExit = $('#btnExit');

    // Modal
    const popup = $('#popup');
    const closePopup = $('#closePopup');

    let logBuffer = [];
    const show = el => el.classList.remove('hidden');
    const hide = el => el.classList.add('hidden');
    const appendLog = (type,msg)=>{
      const line = document.createElement('div');
      line.className = type;
      line.textContent = `[${nowTs()}] ${msg}`;
      logEl.appendChild(line);
      logEl.scrollTop = logEl.scrollHeight;
      logBuffer.push(line.textContent);
    };
    const validNumber = n => /^\d{6,15}$/.test(n.replace(/\s+/g,''));
    const rint = (a,b) => Math.floor(Math.random()*(b-a+1))+a;

    // Start
    btnStart.addEventListener('click', ()=>{
      const cc = ccEl.value.trim();
      const n  = numEl.value.trim().replace(/\s+/g,'');
      if(!validNumber(n)){ alert('Ingresa un número válido (6–15 dígitos).'); return; }

      hide(sLogin);
      show(sVerify);
      verifyTarget.textContent = `Objetivo: ${cc} ${n}`;
      setTimeout(()=> startProgress(`${cc} ${n}`), 1600);
    });

    function startProgress(target){
      hide(sVerify);
      show(sProg);
      targetEl.textContent = target;

      // Reset
      logEl.textContent = '';
      logBuffer = [];
      grid.innerHTML = '';
      resultsWrap.style.display = 'none';
      barEl.style.width = '0%';
      pctEl.textContent = '0%';

      // 30s -> 300 pasos x 100ms
      let step=0, steps=300, interval=100;

      // Logs simples con algún error (continúa)
      const plannedLogs = [
        {t:15,  type:'info', msg:'Inicializando módulos…'},
        {t:30,  type:'info', msg:'Conectando al servidor…'},
        {t:45,  type:'warn', msg:'Latencia elevada, ajustando…'},
        {t:70,  type:'info', msg:'Sesión establecida. Recibiendo metadatos…'},
        {t:95,  type:'error',msg:'Checksum inconsistente. Reintentando…'},
        {t:110, type:'info', msg:'Reintento exitoso. Continuando…'},
        {t:145, type:'info', msg:'Analizando paquetes…'},
        {t:170, type:'info', msg:'Reconstruyendo fragmentos…'},
        {t:200, type:'info', msg:'Descifrando bloques…'},
        {t:230, type:'warn', msg:'Pérdida de paquetes 2%. Compensando…'},
        {t:260, type:'info', msg:'Validando integridad…'},
        {t:290, type:'ok',   msg:'Proceso finalizado. Preparando resultados…'}
      ];

      // 8 métricas (con 🎤 Notas de voz en medio)
      const metrics = [
        { lbl:'💬 Número de chats',           val: rint(120,310) },
        { lbl:'📤 Enviados (foto/video)',     val: rint(210,260) },
        { lbl:'📥 Recibidos (foto/video)',    val: rint(300,350) },
        { lbl:'🎤 Notas de voz',              val: rint(80,420)  },
        { lbl:'👥 Contactos',                 val: rint(150,220) },
        { lbl:'📲 Llamadas entrantes',        val: rint(100,170) },
        { lbl:'📞 Llamadas salientes',        val: rint(100,143) },
        { lbl:'🗑️ Conversaciones eliminadas', val: rint(10,14)   }
      ];

      // Puntos de revelado (8)
      const revealPerc = [12,25,37,50,62,75,87,99];
      const revealTicks = revealPerc.map(p => Math.round(p/100*steps));
      const revealed = new Set();

      const timer = setInterval(()=>{
        step++;
        const pct = Math.min(100, Math.floor(step/steps*100));
        barEl.style.width = pct + '%';
        pctEl.textContent = pct + '%';

        plannedLogs.forEach(l => { if(l.t === step) appendLog(l.type,l.msg); });

        revealTicks.forEach((tick, i)=>{
          if(step === tick && !revealed.has(i)){
            revealed.add(i);
            revealResult(i);
          }
        });

        if(step >= steps){
          clearInterval(timer);
          appendLog('ok','Resultados listos.');
          resultsWrap.style.display = 'block';
        }
      }, interval);

      function revealResult(i){
        const m = metrics[i]; if(!m) return;
        const btn = document.createElement('button');
        btn.className = 'result';
        btn.type = 'button';
        btn.innerHTML = `<div class="big">${m.val.toLocaleString('es')}</div><div class="lbl">${m.lbl}</div>`;
        grid.appendChild(btn);
        setTimeout(()=> btn.classList.add('show'), 40);
      }
    }

    // Copiar logs
    copyBtn.addEventListener('click', async ()=>{
      try{
        await navigator.clipboard.writeText(logBuffer.join('\n'));
        appendLog('ok','Consola copiada al portapapeles.');
      }catch{ appendLog('error','No se pudo copiar al portapapeles.'); }
    });

    // Acciones finales
    btnReset.addEventListener('click', ()=>{
      hide(sProg); hide(sVerify); show(sLogin);
      numEl.value=''; logEl.textContent=''; grid.innerHTML=''; resultsWrap.style.display='none';
    });
    btnDetails.addEventListener('click', ()=> popup.classList.remove('hidden'));
    btnExit.addEventListener('click', ()=> location.reload());

    // Modal
    closePopup.addEventListener('click', ()=> popup.classList.add('hidden'));

    // UX: solo dígitos
    numEl.addEventListener('input', ()=>{ numEl.value = numEl.value.replace(/[^\d]/g,'').slice(0,15); });

    /* =========================
       FLAGS + PLACEHOLDERS (UI)
       ========================= */
    const CC_TO_COUNTRY = {
      '+593':'EC', '+57':'CO', '+51':'PE', '+52':'MX', '+54':'AR', '+34':'ES', '+1':'US'
    };
    const CC_TO_PLACEHOLDER = {
      '+593':'9XX XXX XXX',
      '+57':'3XX XXX XXXX',
      '+51':'9XX XXX XXX',
      '+52':'55 XX XX XXXX',
      '+54':'11 XXXX XXXX',
      '+34':'6XX XX XX XX',
      '+1':'(XXX) XXX-XXXX'
    };
    function getFlagSVG(country){
      const svg = {
        EC: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="22" height="5" y="0" fill="#FCD116"/>
               <rect width="22" height="4" y="5" fill="#003893"/>
               <rect width="22" height="5" y="9" fill="#CE1126"/>
             </svg>`,
        CO: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="22" height="7" y="0" fill="#FCD116"/>
               <rect width="22" height="3.5" y="7" fill="#003893"/>
               <rect width="22" height="3.5" y="10.5" fill="#CE1126"/>
             </svg>`,
        PE: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="7.33" height="14" x="0" fill="#D91023"/>
               <rect width="7.33" height="14" x="7.33" fill="#FFFFFF"/>
               <rect width="7.34" height="14" x="14.66" fill="#D91023"/>
             </svg>`,
        MX: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="7.33" height="14" x="0" fill="#006847"/>
               <rect width="7.33" height="14" x="7.33" fill="#FFFFFF"/>
               <rect width="7.34" height="14" x="14.66" fill="#CE1126"/>
             </svg>`,
        AR: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="22" height="4.66" y="0" fill="#74ACDF"/>
               <rect width="22" height="4.66" y="4.66" fill="#FFFFFF"/>
               <rect width="22" height="4.68" y="9.32" fill="#74ACDF"/>
             </svg>`,
        ES: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="22" height="3.5" y="0" fill="#AA151B"/>
               <rect width="22" height="7" y="3.5" fill="#F1BF00"/>
               <rect width="22" height="3.5" y="10.5" fill="#AA151B"/>
             </svg>`,
        US: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="14">
               <rect width="22" height="14" fill="#B22234"/>
               <rect y="2" width="22" height="2" fill="#FFF"/>
               <rect y="6" width="22" height="2" fill="#FFF"/>
               <rect y="10" width="22" height="2" fill="#FFF"/>
               <rect width="9" height="7" fill="#3C3B6E"/>
             </svg>`
      };
      return svg[country] || svg.ES;
    }
    function updateFlagAndPlaceholder(){
      const cc = ccEl.value;
      const country = CC_TO_COUNTRY[cc] || 'ES';
      const flagHolder = document.getElementById('flagIcon');
      if(flagHolder) flagHolder.innerHTML = getFlagSVG(country);
      numEl.placeholder = CC_TO_PLACEHOLDER[cc] || '9XX XXX XXX';
    }
    ccEl.addEventListener('change', updateFlagAndPlaceholder);
    updateFlagAndPlaceholder();

    /* =========================
       SUBETAPAS + PULSO 100% (UI)
       ========================= */
    // Guardamos referencia de la función original y “enganchamos” UI sin modificar la lógica interna
    const __originalStartProgress = startProgress;
    startProgress = function(target){
      const ret = __originalStartProgress.call(this, target);

      const stagesEl = document.getElementById('stages');
      const chips = stagesEl ? Array.from(stagesEl.querySelectorAll('.chip')) : [];
      const bar = document.getElementById('bar');
      const pctNode = document.getElementById('pct');

      // Hitos alineados a tus plannedLogs
      const stageMarks = [15, 30, 145, 200, 260, 290];
      let pulseDone = false;

      const poll = setInterval(()=>{
        if(!pctNode) return;
        const pct = parseInt(pctNode.textContent.replace('%','')) || 0;

        // Aproximamos step a partir del % (tu lógica real sigue intacta)
        const approxStep = Math.round((pct/100) * 300);

        // Actualiza chips (done/active)
        stageMarks.forEach((mark, idx)=>{
          if(!chips[idx]) return;
          // reset de estado
          chips[idx].classList.remove('active','done');
          // marcar previos como done
          chips.forEach((c,i)=>{ if(i<idx && approxStep >= mark) c.classList.add('done'); });
          // marcar activo el más cercano alcanzado
          if(approxStep >= mark) chips[idx].classList.add('active');
        });

        // pulso al 100%
        if(pct >= 100 && !pulseDone){
          pulseDone = true;
          if(bar){
            bar.classList.add('pulse');
            setTimeout(()=> bar.classList.remove('pulse'), 1700);
          }
          clearInterval(poll);
        }
      }, 120);

      return ret;
    };
  </script>
</body>
</html>
